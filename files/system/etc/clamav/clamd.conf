ExtendedDetectionInfo yes
FixStaleSocket yes
LocalSocket /var/run/clamav/clamd.ctl

LogFile $HOME/log/clamav.log
LogFileMaxSize 5M
LogRotate yes
LogTime yes
LogClean yes
LogSyslog yes

# Rendimiento y control de escaneo
MaxDirectoryRecursion 15
MaxThreads 20

# Archivo PID
PidFile /run/clamav/clamd.pid

# Usuario que ejecuta el servicio (más seguro que root)
User clamav

# Escaneo en tiempo real (On-Access) — requiere soporte de kernel
OnAccessPrevention yes

# Excluir ciertos usuarios del escaneo en tiempo real
OnAccessExcludeUname clamav
OnAccessExcludeUname root

# Incluir solo rutas específicas para escaneo en tiempo real
OnAccessIncludePath /home

# Script que se ejecuta cuando se detecta un virus
VirusEvent /etc/clamav/detected.sh
